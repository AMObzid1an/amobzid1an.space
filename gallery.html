<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gallery â€“ AMObzid1an</title>

  <style>
  /* =========================
     SECTION A: PAGE BASE
  ========================== */
  body{ padding-top: 46px; } /* sits just below the 40px bar */
  body{
    margin:0;font-family:sans-serif;color:#e0e0e0;
    background:url('/background.png') no-repeat center/cover fixed;
    display:flex;flex-direction:column;align-items:center;min-height:100vh;
  }
  h1{margin:2rem 0 .5rem;font-size:2rem;text-shadow:0 0 5px #000;}
/* =========================
   SECTION A1: TOP BAR
========================== */
.topbar{
  position:fixed; top:0; left:0; right:0;
  height:40px;
  background:rgba(0,0,0,.85);
  display:flex; align-items:center; justify-content:flex-end;
  padding:0 12px;
  z-index:1000;
  backdrop-filter:saturate(120%) blur(2px);
  border-bottom:1px solid rgba(255,255,255,.08);
}
.topbar a{
  color:#e0e0e0; text-decoration:none;
  font-size:.9rem; padding:6px 10px; border-radius:6px;
  border:1px solid rgba(255,255,255,.14);
  background:rgba(255,255,255,.06);
  transition:background .2s ease, border-color .2s ease;
}
.topbar a:hover{
  background:rgba(0,187,255,.18);
  border-color:rgba(0,187,255,.45);
}

  /* =========================
     SECTION B: FILTER BAR
  ========================== */
  #filters{
    margin-bottom:1rem;display:flex;flex-wrap:wrap;justify-content:center;gap:8px;
  }
  #filters button{
    padding:6px 14px;background:#333;color:#eee;border:1px solid #555;border-radius:6px;
    cursor:pointer;transition:background .2s ease;
  }
  #filters button.active{background:#6600aa;color:#fff;}
  #filters button:hover{background:#444;}

 .gallery-grid{
  width:90%;max-width:1400px;display:grid;
  grid-template-columns:repeat(auto-fill,minmax(230px,1fr));
  gap:26px;
  padding:2rem 0 4rem;
  box-sizing:border-box;
}


/* =========================
   SECTION D: TILE + STAGE
   - Stage now sizes to the rotated image via aspect-ratio
   - Rotor handles the transform; border/glow stay crisp
========================== */
.gallery-item{
  display:block;
  text-decoration:none;
  color:inherit;
  -webkit-tap-highlight-color:transparent;
}

/* Stage: no fixed height; aspect-ratio is set inline from JS */
.thumb-stage{
  width:100%;
  /* height removed */
  display:block;
  position:relative;
  overflow:hidden;
  border-radius:14px;
  background:rgba(0,0,0,.25);
  padding:0;                 /* stage is now edge-to-edge; glow is on stage */
  box-sizing:border-box;
  border:1px solid rgba(255,255,255,.14);
  box-shadow:0 0 0 0 rgba(0,187,255,0);
  transition:box-shadow .25s ease, transform .2s ease, border-color .25s ease;
}

/* Inner rotor centers the image and applies the rotation */
.thumb-rotor{
  position:absolute; inset:0;
  display:grid; place-items:center;
  transform-origin:50% 50%;
}

/* The image itself is just content; no box-shadow here */
.thumb-rotor img{
  max-width:100%;
  max-height:100%;
  width:auto; height:auto;
  object-fit:contain;
  display:block;
  border-radius:12px;
}

/* Hover glow lives on the stage so it hugs the actual edges */
.gallery-item:hover .thumb-stage{
  border-color:rgba(0,187,255,.45);
  box-shadow:0 0 0 3px rgba(0,187,255,.6), 0 0 28px 8px rgba(0,187,255,.3);
}

/* Keyboard focus */
.gallery-item:focus{ outline:none; }
.gallery-item:focus-within .thumb-stage,
.gallery-item:focus .thumb-stage{
  border-color:rgba(0,187,255,.6);
  box-shadow:0 0 0 3px rgba(0,187,255,.75), 0 0 28px 8px rgba(0,187,255,.35);
}



  /* =========================
     SECTION E: CAPTION
  ========================== */
  .image-title{
    margin-top:.4rem;font-size:.8rem;padding:4px 8px;
    background:rgba(0,0,0,.65);border-radius:6px;max-width:90%;
    overflow-wrap:break-word;text-shadow:0 1px 2px rgba(0,0,0,.6);
    text-align:center;
  }

  /* =========================
     SECTION F: PORTALS
  ========================== */
  .home-portal{position:fixed;top:20px;left:20px;z-index:10;width:90px;height:90px;}
  .home-portal img{width:100%;border-radius:50%;animation:pulse 3s ease-in-out infinite;filter:drop-shadow(0 0 10px #2a0134);}
  .credits-portal{position:fixed;bottom:20px;right:20px;z-index:12;width:70px;height:70px;}
  .credits-portal img{width:100%;border-radius:50%;animation:pulse 4s ease-in-out infinite;filter:drop-shadow(0 0 8px #7700ff);}
  @keyframes pulse{0%,100%{transform:scale(1);filter:drop-shadow(0 0 10px #6a0dad);}50%{transform:scale(1.1);filter:drop-shadow(0 0 18px #3a003d);}}

  /* =========================
     SECTION G: MOBILE TWEAKS
  ========================== */
  @media (max-width:520px){
    .thumb-stage{padding:4px;}
    .gallery-grid{gap:22px;}
  }
  </style>
</head>
<body>
<div class="topbar">
  <a href="/donate.html">Donate</a>
</div>

  <!-- =========================
       SECTION H: PORTAL + TITLE
  ========================== -->
  <a class="home-portal" href="/"><img src="Portal.png" alt="Home"></a>
  <h1>Gallery</h1>

  <!-- =========================
       SECTION I: FILTER CONTROLS
  ========================== -->
  <div id="filters">
    <!-- media type -->
    <button data-group="type" data-value="all" class="active">All Media</button>
    <button data-group="type" data-value="digital">Digital</button>
    <button data-group="type" data-value="traditional">Hand-Drawn</button>
    <!-- orientation -->
    <button data-group="orientation" data-value="all" class="active">Any Orientation</button>
    <button data-group="orientation" data-value="fixed">Fixed</button>
    <button data-group="orientation" data-value="flippable">Flippable</button>
    <button data-group="orientation" data-value="wild">Wild</button>
  </div>

  <!-- =========================
       SECTION J: GRID CONTAINER
  ========================== -->
  <div class="gallery-grid" id="galleryGrid"></div>

  <!-- =========================
       SECTION K: SCRIPT
  ========================== -->
  <script>
  /* K1: IMAGE MANIFEST */
  const images = [
    {thumb:'/assets/gallery/thumbs/85-Verde-Lunaris.jpg', full:'/assets/gallery/full/85-Verde-Lunaris.jpg', title:'85 Verde-Lunaris', type:'digital', orientation:'wild'},
    {thumb:'/assets/gallery/thumbs/XJ-210.jpg',           full:'/assets/gallery/full/XJ-210.jpg',           title:'XJ-210',          type:'digital', orientation:'wild'},
    {thumb:'/assets/gallery/thumbs/UX-214.jpg',           full:'/assets/gallery/full/UX-214.jpg',           title:'UX-214',          type:'digital', orientation:'wild'},
    {thumb:'/assets/gallery/thumbs/105a-Seraphim-Vector.jpg', full:'/assets/gallery/full/105a-Seraphim-Vector.jpg', title:'105a Seraphim Vector', type:'digital', orientation:'fixed'},
    {thumb:'/assets/gallery/thumbs/109-Selenae-Drift.jpg',    full:'/assets/gallery/full/109-Selenae-Drift.jpg',    title:'109 Selenae Drift',    type:'digital', orientation:'fixed'},
    {thumb:'/assets/gallery/thumbs/N217-Hx.jpg',              full:'/assets/gallery/full/N217-Hx.jpg',              title:'N217-Hx',              type:'digital', orientation:'fixed'},
    {thumb:'/assets/gallery/thumbs/Aurum-221.jpg',            full:'/assets/gallery/full/Aurum-221.jpg',            title:'Aurum-221',            type:'digital', orientation:'wild'},
    {thumb:'/assets/gallery/thumbs/Oculus-212.jpg',           full:'/assets/gallery/full/Oculus-212.jpg',           title:'Oculus-212',           type:'digital', orientation:'wild'},
    {thumb:'/assets/gallery/thumbs/Iris-190.jpg',             full:'/assets/gallery/full/Iris-190.jpg',             title:'Iris-190',             type:'digital', orientation:'flippable'}
  ];

  /* K2: SHUFFLE */
  for (let i = images.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [images[i], images[j]] = [images[j], images[i]];
  }

 /* K3: RENDER TILES (stage + rotor + rotation + aspect sizing) */
const grid = document.getElementById('galleryGrid');
const angles = [0, 90, 180, 270];

images.forEach(({thumb, full, title, type, orientation = 'wild'}) => {
  const link = document.createElement('a');
  link.href = `fullview.html?src=${encodeURIComponent(full)}&title=${encodeURIComponent(title || '')}`;
  link.className = 'gallery-item';
  link.dataset.type = type;
  link.dataset.orientation = orientation;

  const stage = document.createElement('div');
  stage.className = 'thumb-stage';

  const rotor = document.createElement('div');
  rotor.className = 'thumb-rotor';

  const img = document.createElement('img');
  img.src = thumb;
  img.alt = title || 'Artwork';
  img.loading = 'lazy';

  // orientation logic
  let rotation = 0;
  if (orientation === 'wild') {
    rotation = angles[Math.floor(Math.random() * angles.length)];
  } else if (orientation === 'flippable') {
    rotation = [0, 180][Math.floor(Math.random() * 2)];
  } // fixed stays 0

  // apply rotation on the rotor; mild scale if 90/270 for visual safety
  const needsScale = rotation % 180 !== 0 ? ' scale(0.95)' : '';
  rotor.style.transform = `rotate(${rotation}deg)${needsScale}`;

  // once the image knows its real size, compute stage aspect-ratio to match rotation
  img.addEventListener('load', () => {
    const w = img.naturalWidth || 1;
    const h = img.naturalHeight || 1;
    const rotated = (rotation % 180 !== 0);

    // final displayed aspect: width/height after rotation
    const ratio = rotated ? (h / w) : (w / h);

    // modern browsers: aspect-ratio
    stage.style.aspectRatio = ratio > 0 ? String(ratio) : '';

    // fallback (very old browsers): explicit height calculation
    // queue microtask to ensure stage has a width from layout
    queueMicrotask(() => {
      if (!('aspectRatio' in document.body.style)) {
        const width = stage.clientWidth || 1;
        stage.style.height = (width / (ratio || 1)) + 'px';
      }
    });
  });

  const cap = document.createElement('div');
  cap.className = 'image-title';
  cap.textContent = title || '';

  rotor.appendChild(img);
  stage.appendChild(rotor);
  link.appendChild(stage);
  link.appendChild(cap);
  grid.appendChild(link);
});

  /* K4: FILTERING (type + orientation) */
  const state = { type: 'all', orientation: 'all' };
  document.querySelectorAll('#filters button').forEach(btn => {
    btn.addEventListener('click', () => {
      const { group, value } = btn.dataset;
      document.querySelectorAll(`#filters button[data-group="${group}"]`)
        .forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      state[group] = value;
      applyFilters();
    });
  });

  function applyFilters(){
    document.querySelectorAll('.gallery-item').forEach(item => {
      const okType = state.type === 'all' || item.dataset.type === state.type;
      const okOri  = state.orientation === 'all' || item.dataset.orientation === state.orientation;
      item.style.display = (okType && okOri) ? 'block' : 'none';
    });
  }
  </script>

  <!-- =========================
       SECTION L: CREDITS PORTAL
  ========================== -->
  <a class="credits-portal" href="/credits.html" target="_blank" title="Usage & Credits">
    <img src="Portal.png" alt="Credits">
  </a>
</body>
</html>


